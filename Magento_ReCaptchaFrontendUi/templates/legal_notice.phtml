<?php
/**
 * Hyvä Themes - https://hyva.io
 * Copyright © Hyvä Themes. All rights reserved.
 * See COPYING.txt for license details.
 */

declare(strict_types=1);

use Hyva\Theme\Model\ViewModelRegistry;
use Hyva\Theme\ViewModel\Escaper\EscapeHtmlAllowingAnchorAttributes;
use Hyva\Theme\ViewModel\HeroiconsOutline;
use Magento\Framework\Escaper;

// phpcs:disable Generic.Files.LineLength.TooLong

/** @var ViewModelRegistry $viewModels */
/** @var Escaper $escaper */
/** @var EscapeHtmlAllowingAnchorAttributes $specialEscaper */

$specialEscaper = $viewModels->require(EscapeHtmlAllowingAnchorAttributes::class);
$heroicons = $viewModels->require(HeroiconsOutline::class);
?>
<div class="relative inline-block group my-4 right" x-data="{ open: false }">
    <button type="button"
            @click="open = !open"
            @mouseenter="open = true"
            @mouseleave="open = false"
            class="text-gray-500 hover:text-gray-700 focus:outline-none"
            aria-label="<?= $escaper->escapeHtmlAttr(__('reCAPTCHA Information')) ?>">
        <?= $heroicons->shieldCheckHtml('w-6 h-6', 24, 24) ?>
    </button>
    <div x-show="open"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 translate-y-1"
         x-transition:enter-end="opacity-100 translate-y-0"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 translate-y-0"
         x-transition:leave-end="opacity-0 translate-y-1"
         class="absolute bottom-full left-0 mb-2 w-64 p-3 bg-white border border-gray-200 rounded-lg shadow-lg text-xs text-gray-600 z-10"
         @mouseenter="open = true"
         @mouseleave="open = false"
         style="display: none;">
        <?= $specialEscaper->escapeHtml(
            __(
                'This form is protected by reCAPTCHA - the <a class="underline text-blue-600 hover:text-blue-800" href="%1" target="_blank" rel="noopener">Google Privacy Policy</a> and <a class="underline text-blue-600 hover:text-blue-800" href="%2" target="_blank" rel="noopener">Terms of Service</a> apply.',
                'https://policies.google.com/privacy',
                'https://policies.google.com/terms'
            ),
            ['a']
        ) ?>
        <div class="absolute top-full left-3 -mt-px w-2 h-2 bg-white border-b border-r border-gray-200 transform rotate-45"></div>
    </div>
</div>
